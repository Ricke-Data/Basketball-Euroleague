--partizan - crvena zvezda ABA1
exec  match.result_match(1,'partizan','zvezda',17,25,30,11,25,27,26,24,null,null,null,null,null,null,null,null,to_date('30-10-23','dd-mm-yy'));
exec  match.stat_player('Joel','bolomboy','zvezda',1,10,1,2);
exec  match.stat_player('dejan','davidovac','zvezda',1,7,0,2);
exec  match.stat_player('milos','teodosic','zvezda',1,10,3,3);
exec  match.stat_player('luka','mitrovic','zvezda',1,12,5,3);
exec  match.stat_player('rokas','giedraitis','zvezda',1,13,6,1);
exec  match.stat_player('Yago','Mateus','zvezda',1,7,2,3);

exec  match.stat_player('aleksa','avramovic','partizan',1,15,1,6);
exec  match.stat_player('james','nunnally','partizan',1,5,0,2);
exec  match.stat_player('Frank','kaminsky','partizan',1,22,3,0);
exec  match.stat_player('pj','dozier','partizan',1,12,4,8);
exec  match.stat_player('danilo','andjusic','partizan',1,11,0,0);
exec  match.stat_player('alen','smailagic','partizan',1,8,4,1);
exec  match.stat_player('Zach','LeDay','partizan',1,13,4,2);

--crvena zvezda - partizan ABA2
exec  match.result_match(2,'zvezda','partizan',28,15,27,23,17,18,16,30,null,null,null,null,null,null,null,null,to_date('28/01/24','dd/mm/yy'));
exec  match.stat_player('nemanja','nedovic','zvezda',2,11,1,4);
exec  match.stat_player('Joel','bolomboy','zvezda',2,14,13,2);
exec  match.stat_player('dejan','davidovac','zvezda',2,5,1,0);
exec  match.stat_player('milos','teodosic','zvezda',2,7,0,5);
exec  match.stat_player('luka','mitrovic','zvezda',2,6,2,0);
exec  match.stat_player('rokas','giedraitis','zvezda',2,10,1,1);
exec  match.stat_player('Adam','hanga','zvezda',2,15,3,0);
exec  match.stat_player('Ja''Vonte','Smart','zvezda',2,4,1,0);
exec  match.stat_player('Yago','Mateus','zvezda',2,13,3,4);

exec  match.stat_player('aleksa','avramovic','partizan',2,13,3,4);
exec  match.stat_player('kevin','punter','partizan',2,14,4,1);
exec  match.stat_player('james','nunnally','partizan',2,19,3,4);
exec  match.stat_player('Bruno','Caboclo','partizan',2,0,4,0);
exec  match.stat_player('Frank','kaminsky','partizan',2,18,5,1);
exec  match.stat_player('pj','dozier','partizan',2,7,2,4);
exec  match.stat_player('alen','smailagic','partizan',2,0,0,0);
exec  match.stat_player('Zach','LeDay','partizan',2,13,6,2);



--virtus - zvezda
exec  match.result_match(4,'virtus','zvezda',26,15,18,18,18,22,23,24,null,null,null,null,null,null,null,null,to_date('20/10/23 20:30','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',4,3,1,2);
exec  match.stat_player('Joel','bolomboy','zvezda',4,8,9,3);
exec  match.stat_player('dejan','davidovac','zvezda',4,4,1,0);
exec  match.stat_player('milos','teodosic','zvezda',4,5,1,4);
exec  match.stat_player('luka','mitrovic','zvezda',4,14,4,2);
exec  match.stat_player('rokas','giedraitis','zvezda',4,6,2,0);
exec  match.stat_player('Adam','hanga','zvezda',4,11,5,1);
exec  match.stat_player('shabazz','napier','zvezda',4,23,4,5);
exec  match.stat_player('branko','lazic','zvezda',4,4,3,0);
exec  match.stat_player('Yago','Mateus','zvezda',4,0,0,0);

exec  match.stat_player('tornike','shengelia','virtus',4,19,6,5);
exec  match.stat_player('gabriel','lundberg','virtus',4,10,3,3);
exec  match.stat_player('marco','belinelli','virtus',4,15,2,2);
exec  match.stat_player('jordan','mickey','virtus',4,13,8,2);
exec  match.stat_player('ognjen','dobric','virtus',4,2,0,2);
exec  match.stat_player('daniel','hackett','virtus',4,4,2,2);
exec  match.stat_player('jaleen','smith','virtus',4,0,1,0);

--partizan - crvena zvezda EU1
exec  match.result_match(5,'partizan','zvezda',22,13,20,29,11,23,35,21,null,null,null,null,null,null,null,null,to_date('26-10-23','dd-mm-yy'));
exec  match.stat_player('Joel','bolomboy','zvezda',5,16,2,1);
exec  match.stat_player('dejan','davidovac','zvezda',5,2,1,1);
exec  match.stat_player('milos','teodosic','zvezda',5,9,4,6);
exec  match.stat_player('luka','mitrovic','zvezda',5,8,8,2);
exec  match.stat_player('rokas','giedraitis','zvezda',5,8,2,0);
exec  match.stat_player('Adam','hanga','zvezda',5,11,4,2);
exec  match.stat_player('Yago','Mateus','zvezda',5,11,0,5);

exec  match.stat_player('aleksa','avramovic','partizan',5,14,2,1);
exec  match.stat_player('kevin','punter','partizan',5,8,0,2);
exec  match.stat_player('james','nunnally','partizan',5,7,3,4);
exec  match.stat_player('Frank','kaminsky','partizan',5,11,5,1);
exec  match.stat_player('pj','dozier','partizan',5,9,4,2);
exec  match.stat_player('alen','smailagic','partizan',5,9,3,0);
exec  match.stat_player('Zach','LeDay','partizan',5,13,3,4);
exec  match.stat_player('danilo','andjusic','partizan',5,5,2,2);

--partizan - fenerbahce
exec  match.result_match(7,'partizan','fener',23,27,24,29,16,13,22,15,null,null,null,null,null,null,null,null,to_date('09-11-23 20:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('aleksa','avramovic','partizan',7,7,2,1);
exec  match.stat_player('james','nunnally','partizan',7,13,3,2);
exec  match.stat_player('Frank','kaminsky','partizan',7,15,3,3);
exec  match.stat_player('pj','dozier','partizan',7,5,2,5);
exec  match.stat_player('danilo','andjusic','partizan',7,9,2,2);
exec  match.stat_player('alen','smailagic','partizan',7,13,1,1);
exec  match.stat_player('mateusz','ponitka','partizan',7,2,0,0);
exec  match.stat_player('zach','LeDay','partizan',7,2,7,5);

exec  match.stat_player('nigel','Hayes-Davis','fenerb',7,23,6,3);
exec  match.stat_player('johnathan','motley','fenerb',7,11,5,1);
exec  match.stat_player('tyler','dorsey','fenerb',7,18,4,5);
exec  match.stat_player('scott','wilbekin','fenerb',7,9,2,3);
exec  match.stat_player('georgios','papagiannis','fenerb',7,7,6,1);

--zvezda - fenerbahce
exec  match.result_match(8,'zvezda','fener',25,16,20,10,15,14,27,16,null,null,null,null,null,null,null,null,to_date('14-11-23 20:45','dd-mm-yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',8,12,4,5);
exec  match.stat_player('Joel','bolomboy','zvezda',8,14,2,0);
exec  match.stat_player('dejan','davidovac','zvezda',8,3,2,3);
exec  match.stat_player('milos','teodosic','zvezda',8,18,1,3);
exec  match.stat_player('luka','mitrovic','zvezda',8,8,8,1);
exec  match.stat_player('rokas','giedraitis','zvezda',8,7,3,0);
exec  match.stat_player('Yago','Mateus','zvezda',8,11,4,4);
exec  match.stat_player('shabazz','napier','zvezda',8,0,0,0);

exec  match.stat_player('nigel','Hayes-Davis','fenerb',8,12,3,1);
exec  match.stat_player('johnathan','motley','fenerb',8,8,4,2);
exec  match.stat_player('tyler','dorsey','fenerb',8,3,1,1);
exec  match.stat_player('scott','wilbekin','fenerb',8,6,3,1);
exec  match.stat_player('georgios','papagiannis','fenerb',8,6,4,2);

--olympiacos - zvezda
exec  match.result_match(9,'olympiac','zvezda',20,23,25,21,19,9,24,30,null,null,null,null,null,null,null,null,to_date('16/11/23 20:15','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',9,26,3,4);
exec  match.stat_player('Joel','bolomboy','zvezda',9,7,4,0);
exec  match.stat_player('luka','mitrovic','zvezda',9,8,5,1);
exec  match.stat_player('dejan','davidovac','zvezda',9,5,1,1);
exec  match.stat_player('milos','teodosic','zvezda',9,15,3,4);
exec  match.stat_player('rokas','giedraitis','zvezda',9,6,3,0);
exec  match.stat_player('Yago','Mateus','zvezda',9,9,1,3);

exec  match.stat_player('alec','peters','olympiacos',9,28,4,3);
exec  match.stat_player('moustapha','fall','olympiacos',9,14,14,3);
exec  match.stat_player('isaiah','canaan','olympiacos',9,15,3,2);
exec  match.stat_player('kostas','papanikolaou','olympiacos',9,11,5,5);

--efes - partizan
exec  match.result_match(10,'efes','partizan',22,22,28,23,14,29,36,20,null,null,null,null,null,null,null,null,to_date('24-11-23 18:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('james','nunnally','partizan',10,16,8,3);
exec  match.stat_player('Frank','kaminsky','partizan',10,24,4,3);
exec  match.stat_player('pj','dozier','partizan',10,21,1,5);
exec  match.stat_player('danilo','andjusic','partizan',10,9,0,1);
exec  match.stat_player('alen','smailagic','partizan',10,5,1,0);
exec  match.stat_player('mateusz','ponitka','partizan',10,7,4,3);
exec  match.stat_player('zach','LeDay','partizan',10,2,4,3);
exec  match.stat_player('bruno','caboclo','partizan',10,9,5,1);

exec  match.stat_player('shane','larkin','efes',10,27,3,8);
exec  match.stat_player('darius','thompson','efes',10,18,0,2);
exec  match.stat_player('william','clyburn','efes',10,12,1,2);
exec  match.stat_player('rodrigue','beaubois','efes',10,8,3,2);

--partizan - panathinaikos
exec  match.result_match(11,'partizan','panathina',20,21,19,17,15,18,24,22,14,9,null,null,null,null,null,null,to_date('30-11-23 20:45','dd-mm-yy hh24:mi'));
exec  match.stat_player('james','nunnally','partizan',11,7,0,1);
exec  match.stat_player('Frank','kaminsky','partizan',11,5,3,1);
exec  match.stat_player('pj','dozier','partizan',11,16,7,4);
exec  match.stat_player('danilo','andjusic','partizan',11,2,8,0);
exec  match.stat_player('alen','smailagic','partizan',11,7,4,2);
exec  match.stat_player('mateusz','ponitka','partizan',11,0,0,0);
exec  match.stat_player('zach','LeDay','partizan',11,23,5,2);
exec  match.stat_player('bruno','caboclo','partizan',11,12,5,0);
exec  match.stat_player('kevin','punter','partizan',11,13,2,3);
exec  match.stat_player('aleksa','avramovic','partizan',11,5,0,1);

exec  match.stat_player('marius','grigonis','panathinai',11,12,2,4);
exec  match.stat_player('kendrick','nunn','panathinai',11,19,5,3);
exec  match.stat_player('mathias','lessort','panathinai',11,16,6,1);
exec  match.stat_player('jerian','grant','panathinai',11,14,3,5);
exec  match.stat_player('kostas','sloukas','panathinai',11,6,3,5);
exec  match.stat_player('luca','vildoza','panathinai',11,0,2,1);

--zvezda - efes
exec  match.result_match(11,'zvezda','efes',22,21,21,28,29,21,25,13,null,null,null,null,null,null,null,null,to_date('01/12/23 20:00','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',8,23,2,3);
exec  match.stat_player('Joel','bolomboy','zvezda',8,13,5,2);
exec  match.stat_player('Yago','Mateus','zvezda',8,15,4,5);
exec  match.stat_player('milos','teodosic','zvezda',8,9,3,4);
exec  match.stat_player('luka','mitrovic','zvezda',8,19,7,3);
exec  match.stat_player('rokas','giedraitis','zvezda',8,2,5,0);
exec  match.stat_player('dejan','davidovac','zvezda',8,2,2,1);
exec  match.stat_player('shabazz','napier','zvezda',8,7,2,2);
exec  match.stat_player('branko','lazic','zvezda',8,0,0,0);

exec  match.stat_player('shane','larkin','efes',11,21,0,5);
exec  match.stat_player('darius','thompson','efes',11,9,4,2);
exec  match.stat_player('william','clyburn','efes',11,17,5,3);
exec  match.stat_player('rodrigue','beaubois','efes',11,13,1,2);

--zvezda - real
exec  match.result_match(15,'zvezda','real',20,20,14,25,11,16,13,11,null,null,null,null,null,null,null,null,to_date('19/12/23 19:00','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',15,4,1,0);
exec  match.stat_player('Joel','bolomboy','zvezda',15,2,10,0);
exec  match.stat_player('Yago','Mateus','zvezda',15,0,2,4);
exec  match.stat_player('milos','teodosic','zvezda',15,14,2,5);
exec  match.stat_player('luka','mitrovic','zvezda',15,14,4,1);
exec  match.stat_player('rokas','giedraitis','zvezda',15,0,2,0);
exec  match.stat_player('dejan','davidovac','zvezda',15,3,3,0);
exec  match.stat_player('adam','hanga','zvezda',15,10,3,4);
exec  match.stat_player('branko','lazic','zvezda',15,5,2,1);

exec  match.stat_player('facundo','campazzo','real',15,3,4,2);
exec  match.stat_player('dzanan','musa','real',15,4,1,2);
exec  match.stat_player('mario','hezonja','real',15,17,10,0);
exec  match.stat_player('edy','tavares','real',15,8,6,3);
exec  match.stat_player('vincent','poirier','real',15,14,0,1);

--real - partizan
exec  match.result_match(16,'real','partizan',26,19,22,17,28,15,15,24,null,null,null,null,null,null,null,null,to_date('21-12-23 20:45','dd-mm-yy hh24:mi'));
exec  match.stat_player('kevin','punter','partizan',16,4,2,3);
exec  match.stat_player('james','nunnally','partizan',16,8,3,4);
exec  match.stat_player('Bruno','Caboclo','partizan',16,18,3,0);
exec  match.stat_player('Frank','kaminsky','partizan',16,0,0,0);
exec  match.stat_player('pj','dozier','partizan',16,2,3,1);
exec  match.stat_player('danilo','andjusic','partizan',16,0,1,0);
exec  match.stat_player('alen','smailagic','partizan',16,7,5,3);
exec  match.stat_player('zach','LeDay','partizan',16,7,2,0);
exec  match.stat_player('mateusz','ponitka','partizan',16,4,7,2);

exec  match.stat_player('facundo','campazzo','real',16,10,1,4);
exec  match.stat_player('dzanan','musa','real',16,23,4,2);
exec  match.stat_player('mario','hezonja','real',16,14,3,0);
exec  match.stat_player('edy','tavares','real',16,6,8,1);
exec  match.stat_player('vincent','poirier','real',16,14,1,0);

--partizan - virtus
exec  match.result_match(17,'partizan','virtus',18,23,18,18,19,19,20,17,null,null,null,null,null,null,null,null,to_date('28-12-23 18:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('kevin','punter','partizan',17,12,4,2);
exec  match.stat_player('james','nunnally','partizan',17,19,4,6);
exec  match.stat_player('Bruno','Caboclo','partizan',17,10,3,0);
exec  match.stat_player('Frank','kaminsky','partizan',17,10,3,1);
exec  match.stat_player('pj','dozier','partizan',17,5,1,1);
exec  match.stat_player('danilo','andjusic','partizan',17,0,1,0);
exec  match.stat_player('zach','LeDay','partizan',17,5,3,0);
exec  match.stat_player('mateusz','ponitka','partizan',17,2,2,0);

exec  match.stat_player('tornike','shengelia','virtus',17,10,1,4);
exec  match.stat_player('gabriel','lundberg','virtus',17,16,2,3);
exec  match.stat_player('marco','belinelli','virtus',17,14,3,1);
exec  match.stat_player('ognjen','dobric','virtus',17,0,0,0);
exec  match.stat_player('daniel','hackett','virtus',17,10,2,4);

--panathinaikos - zvezda
exec  match.result_match(17,'panathinaikos','zvezda',20,17,18,14,23,19,21,15,null,null,null,null,null,null,null,null,to_date('28/12/23 20:15','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',17,15,2,1);
exec  match.stat_player('Joel','bolomboy','zvezda',17,15,5,0);
exec  match.stat_player('Yago','Mateus','zvezda',17,12,3,4);
exec  match.stat_player('milos','teodosic','zvezda',17,0,1,3);
exec  match.stat_player('luka','mitrovic','zvezda',17,12,6,0);
exec  match.stat_player('rokas','giedraitis','zvezda',17,1,1,2);
exec  match.stat_player('dejan','davidovac','zvezda',17,2,7,0);
exec  match.stat_player('adam','hanga','zvezda',17,6,0,1);
exec  match.stat_player('branko','lazic','zvezda',17,0,0,1);

exec  match.stat_player('kendrick','nunn','panathinai',17,6,2,1);
exec  match.stat_player('mathias','lessort','panathinai',17,13,4,1);
exec  match.stat_player('jerian','grant','panathinai',17,14,3,2);
exec  match.stat_player('kostas','sloukas','panathinai',17,9,3,7);
exec  match.stat_player('luca','vildoza','panathinai',17,2,0,0);
exec  match.stat_player('marius','grigonis','panathinai',17,9,5,0);

--fenerbahce - zvezda
exec  match.result_match(18,'fener','zvezda',26,18,9,16,22,23,19,28,null,null,null,null,null,null,null,null,to_date('02-01-24 18:45','dd-mm-yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',18,7,3,2);
exec  match.stat_player('Joel','bolomboy','zvezda',18,24,6,0);
exec  match.stat_player('dejan','davidovac','zvezda',18,0,3,1);
exec  match.stat_player('milos','teodosic','zvezda',18,6,3,8);
exec  match.stat_player('rokas','giedraitis','zvezda',18,19,7,0);
exec  match.stat_player('Yago','Mateus','zvezda',18,2,0,4);
exec  match.stat_player('branko','lazic','zvezda',18,8,1,0);
exec  match.stat_player('adam','hanga','zvezda',18,12,4,0);

exec  match.stat_player('nigel','Hayes-Davis','fenerb',18,21,9,1);
exec  match.stat_player('johnathan','motley','fenerb',18,11,6,3);
exec  match.stat_player('tyler','dorsey','fenerb',18,8,1,1);
exec  match.stat_player('scott','wilbekin','fenerb',18,14,1,4);
exec  match.stat_player('georgios','papagiannis','fenerb',18,0,2,2);
exec  match.stat_player('marko','guduric','fenerb',18,3,2,0);
exec  match.stat_player('nick','calathes','fenerb',18,2,4,3);

--crvena zvezda - partizan EU2
exec  match.result_match(19,'zvezda','partizan',24,13,26,16,15,19,23,24,null,null,null,null,null,null,null,null,to_date('04/01/24','dd/mm/yy'));
exec  match.stat_player('nemanja','nedovic','zvezda',19,16,1,3);
exec  match.stat_player('Joel','bolomboy','zvezda',19,4,5,1);
exec  match.stat_player('dejan','davidovac','zvezda',19,3,1,0);
exec  match.stat_player('milos','teodosic','zvezda',19,13,2,7);
exec  match.stat_player('rokas','giedraitis','zvezda',19,14,7,1);
exec  match.stat_player('Adam','hanga','zvezda',19,11,3,2);
exec  match.stat_player('Yago','Mateus','zvezda',19,10,2,3);

exec  match.stat_player('kevin','punter','partizan',19,17,0,1);
exec  match.stat_player('james','nunnally','partizan',19,11,4,3);
exec  match.stat_player('Bruno','Caboclo','partizan',19,10,7,0);
exec  match.stat_player('Frank','kaminsky','partizan',19,11,2,0);
exec  match.stat_player('pj','dozier','partizan',19,12,2,3);
exec  match.stat_player('alen','smailagic','partizan',19,0,2,1);
exec  match.stat_player('danilo','andjusic','partizan',19,2,0,0);

--fenerbahce - partizan
exec  match.result_match(20,'fener','partizan',19,31,24,17,25,16,23,12,null,null,null,null,null,null,null,null,to_date('09-01-24 18:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('kevin','punter','partizan',20,18,4,1);
exec  match.stat_player('james','nunnally','partizan',20,14,1,0);
exec  match.stat_player('Bruno','Caboclo','partizan',20,13,4,1);
exec  match.stat_player('Frank','kaminsky','partizan',20,7,1,0);
exec  match.stat_player('pj','dozier','partizan',20,4,1,6);
exec  match.stat_player('danilo','andjusic','partizan',20,3,1,0);
exec  match.stat_player('zach','LeDay','partizan',20,1,6,2);
exec  match.stat_player('jaleen','smith','partizan',20,11,1,2);

exec  match.stat_player('nigel','Hayes-Davis','fenerb',20,12,7,1);
exec  match.stat_player('johnathan','motley','fenerb',20,4,0,0);
exec  match.stat_player('tyler','dorsey','fenerb',20,24,1,0);
exec  match.stat_player('scott','wilbekin','fenerb',20,0,1,2);
exec  match.stat_player('georgios','papagiannis','fenerb',20,2,4,3);
exec  match.stat_player('marko','guduric','fenerb',20,15,3,1);
exec  match.stat_player('nick','calathes','fenerb',20,9,4,7);
exec  match.stat_player('dyshawn','pierre','fenerb',20,4,2,1);

--panathinaikos - partizan
exec  match.result_match(22,'panathina','partizan',18,16,24,24,16,18,26,13,null,null,null,null,null,null,null,null,to_date('19-01-24 20:15','dd-mm-yy hh24:mi'));
exec  match.stat_player('james','nunnally','partizan',22,13,3,0);
exec  match.stat_player('Frank','kaminsky','partizan',22,0,0,0);
exec  match.stat_player('pj','dozier','partizan',22,16,7,8);
exec  match.stat_player('danilo','andjusic','partizan',22,5,1,0);
exec  match.stat_player('alen','smailagic','partizan',22,11,3,2);
exec  match.stat_player('mateusz','ponitka','partizan',22,0,2,0);
exec  match.stat_player('zach','LeDay','partizan',22,4,2,2);
exec  match.stat_player('bruno','caboclo','partizan',22,8,1,0);
exec  match.stat_player('jaleen','smith','partizan',22,6,1,1);

exec  match.stat_player('marius','grigonis','panathinai',22,10,3,1);
exec  match.stat_player('kendrick','nunn','panathinai',22,21,1,4);
exec  match.stat_player('mathias','lessort','panathinai',22,14,9,1);
exec  match.stat_player('jerian','grant','panathinai',22,4,2,6);
exec  match.stat_player('kostas','sloukas','panathinai',22,10,1,4);

--virtus - partizan
exec  match.result_match(25,'virtus','partizan',19,19,16,12,27,27,26,26,null,null,null,null,null,null,null,null,to_date('02-02-24 20:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('kevin','punter','partizan',25,22,2,1);
exec  match.stat_player('james','nunnally','partizan',25,18,1,0);
exec  match.stat_player('Bruno','Caboclo','partizan',25,0,0,0);
exec  match.stat_player('Frank','kaminsky','partizan',25,2,2,0);
exec  match.stat_player('pj','dozier','partizan',25,10,4,3);
exec  match.stat_player('alen','smailagic','partizan',25,6,1,0);
exec  match.stat_player('zach','LeDay','partizan',25,0,3,0);
exec  match.stat_player('mateusz','ponitka','partizan',25,0,2,0);
exec  match.stat_player('aleksa','avramovic','partizan',25,16,3,2);
exec  match.stat_player('jaleen','smith','partizan',25,6,1,2);

exec  match.stat_player('tornike','shengelia','virtus',25,8,5,1);
exec  match.stat_player('gabriel','lundberg','virtus',25,20,5,2);
exec  match.stat_player('marco','belinelli','virtus',25,20,2,4);
exec  match.stat_player('ognjen','dobric','virtus',25,0,0,0);
exec  match.stat_player('daniel','hackett','virtus',25,7,3,4);
exec  match.stat_player('jordan','mickey','virtus',25,4,1,0);

--partizan - efes
exec  match.result_match(27,'partizan','efes',17,20,26,20,21,19,36,31,null,null,null,null,null,null,null,null,to_date('29-02-24 20:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('Frank','kaminsky','partizan',27,0,4,2);
exec  match.stat_player('pj','dozier','partizan',27,5,0,0);
exec  match.stat_player('danilo','andjusic','partizan',27,15,0,1);
exec  match.stat_player('alen','smailagic','partizan',27,0,0,0);
exec  match.stat_player('mateusz','ponitka','partizan',27,2,6,4);
exec  match.stat_player('zach','LeDay','partizan',27,21,8,1);
exec  match.stat_player('bruno','caboclo','partizan',27,6,1,0);
exec  match.stat_player('kevin','punter','partizan',27,16,1,3);
exec  match.stat_player('aleksa','avramovic','partizan',27,30,2,3);

exec  match.stat_player('shane','larkin','efes',27,11,5,6);
exec  match.stat_player('darius','thompson','efes',27,4,0,1);
exec  match.stat_player('william','clyburn','efes',27,17,4,1);
exec  match.stat_player('rodrigue','beaubois','efes',27,9,1,3);
exec  match.stat_player('elijah','bryant','efes',27,8,1,0);
exec  match.stat_player('tibor','pleiss','efes',27,13,2,2);

--zvezda - panathinaikos
exec  match.result_match(30,'zvezda','panathinaikos',20,29,21,22,15,19,20,19,null,null,null,null,null,null,null,null,to_date('20/03/24 20:00','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',30,19,3,7);
exec  match.stat_player('Joel','bolomboy','zvezda',30,11,8,1);
exec  match.stat_player('milos','teodosic','zvezda',30,4,1,6);
exec  match.stat_player('luka','mitrovic','zvezda',30,6,2,2);
exec  match.stat_player('rokas','giedraitis','zvezda',30,4,0,0);
exec  match.stat_player('dejan','davidovac','zvezda',30,19,1,1);
exec  match.stat_player('adam','hanga','zvezda',30,2,3,3);

exec  match.stat_player('kendrick','nunn','panathinai',30,19,6,4);
exec  match.stat_player('mathias','lessort','panathinai',30,13,4,1);
exec  match.stat_player('jerian','grant','panathinai',30,12,4,5);
exec  match.stat_player('kostas','sloukas','panathinai',30,17,2,10);
exec  match.stat_player('marius','grigonis','panathinai',30,8,3,1);

--zvezda - virtus
exec  match.result_match(31,'zvezda','virtus',21,23,27,19,26,23,20,14,null,null,null,null,null,null,null,null,to_date('22/03/24','dd/mm/yy'));
exec  match.stat_player('nemanja','nedovic','zvezda',31,25,3,7);
exec  match.stat_player('Joel','bolomboy','zvezda',31,15,5,0);
exec  match.stat_player('dejan','davidovac','zvezda',31,11,5,2);
exec  match.stat_player('milos','teodosic','zvezda',31,11,3,9);
exec  match.stat_player('luka','mitrovic','zvezda',31,10,5,2);
exec  match.stat_player('rokas','giedraitis','zvezda',31,7,1,2);
exec  match.stat_player('dalibor','Ilic','zvezda',31,5,3,1);
exec  match.stat_player('Adam','hanga','zvezda',31,3,7,7);
exec  match.stat_player('Ja''Vonte','Smart','zvezda',31,0,0,0);

exec  match.stat_player('tornike','shengelia','virtus',31,25,4,5);
exec  match.stat_player('gabriel','lundberg','virtus',31,15,2,3);
exec  match.stat_player('marco','belinelli','virtus',31,14,3,3);
exec  match.stat_player('jordan','mickey','virtus',31,8,3,1);
exec  match.stat_player('ognjen','dobric','virtus',31,2,1,0);

--partizan - real madrid
exec  match.result_match(31,'partizan','real',13,13,18,20,23,35,22,20,null,null,null,null,null,null,null,null,to_date('21-03-24','dd-mm-yy'));
exec  match.stat_player('aleksa','avramovic','partizan',31,10,1,0);
exec  match.stat_player('kevin','punter','partizan',31,16,7,3);
exec  match.stat_player('james','nunnally','partizan',31,16,5,3);
exec  match.stat_player('Bruno','Caboclo','partizan',31,9,6,0);
exec  match.stat_player('Frank','kaminsky','partizan',31,19,4,2);
exec  match.stat_player('pj','dozier','partizan',31,3,0,1);
exec  match.stat_player('danilo','andjusic','partizan',31,3,1,0);
exec  match.stat_player('alen','smailagic','partizan',31,0,4,0);
exec  match.stat_player('mateusz','ponitka','partizan',31,0,3,0);

exec  match.stat_player('facundo','campazzo','real',31,7,2,8);
exec  match.stat_player('dzanan','musa','real',31,3,1,0);
exec  match.stat_player('mario','hezonja','real',31,25,6,4);
exec  match.stat_player('gabriel','deck','real',31,13,5,1);
exec  match.stat_player('edy','tavares','real',31,8,2,1);
exec  match.stat_player('vincent','poirier','real',31,7,8,1);
exec  match.stat_player('guerschon','yabusele','real',31,10,7,3);

--partizan - olympiacos
exec  match.result_match(32,'partizan','olympiacos',22,17,18,15,19,14,10,28,null,null,null,null,null,null,null,null,to_date('28-03-24 20:30','dd-mm-yy hh24:mi'));
exec  match.stat_player('aleksa','avramovic','partizan',32,0,1,0);
exec  match.stat_player('kevin','punter','partizan',32,19,2,5);
exec  match.stat_player('james','nunnally','partizan',32,0,1,0);
exec  match.stat_player('Bruno','Caboclo','partizan',32,13,8,1);
exec  match.stat_player('Frank','kaminsky','partizan',32,14,8,5);
exec  match.stat_player('pj','dozier','partizan',32,12,9,4);
exec  match.stat_player('alen','smailagic','partizan',32,3,0,0);
exec  match.stat_player('mateusz','ponitka','partizan',32,8,7,1);

exec  match.stat_player('MOSES','WRight','olympiacos',32,6,2,0);
exec  match.stat_player('moustapha','fall','olympiacos',32,7,4,2);
exec  match.stat_player('shaquielle','mckissic','olympiacos',32,4,0,0);
exec  match.stat_player('kostas','papanikolaou','olympiacos',32,13,3,2);
exec  match.stat_player('nigel','Williams-Goss','olympiacos',32,17,3,3);
exec  match.stat_player('alec','peters','olympiacos',32,3,1,0);
exec  match.stat_player('isaiah','canaan','olympiacos',32,10,1,0);

--real - zvezda
exec  match.result_match(32,'real','zvezda',20,21,24,26,28,28,29,19,null,null,null,null,null,null,null,null,to_date('29/03/24 20:30','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',32,30,4,5);
exec  match.stat_player('Joel','bolomboy','zvezda',32,5,2,0);
exec  match.stat_player('luka','mitrovic','zvezda',32,6,4,1);
exec  match.stat_player('rokas','giedraitis','zvezda',32,2,1,0);
exec  match.stat_player('dejan','davidovac','zvezda',32,6,2,0);
exec  match.stat_player('adam','hanga','zvezda',32,22,6,7);
exec  match.stat_player('branko','lazic','zvezda',32,3,1,0);

exec  match.stat_player('dzanan','musa','real',32,30,4,2);
exec  match.stat_player('mario','hezonja','real',32,20,5,2);
exec  match.stat_player('edy','tavares','real',32,11,11,0);
exec  match.stat_player('guerschon','yabusele','real',32,16,5,3);

--crvena zvezda - olympiacos
exec  match.result_match(33,'zvezda','olympiac',14,23,25,19,25,21,22,26,null,null,null,null,null,null,null,null,to_date('04/04/24','dd/mm/yy'));
exec  match.stat_player('nemanja','nedovic','zvezda',33,15,4,4);
exec  match.stat_player('Joel','bolomboy','zvezda',33,19,12,1);
exec  match.stat_player('luka','mitrovic','zvezda',33,8,3,2);
exec  match.stat_player('dejan','davidovac','zvezda',33,1,2,0);
exec  match.stat_player('milos','teodosic','zvezda',33,6,2,8);
exec  match.stat_player('rokas','giedraitis','zvezda',33,16,7,0);
exec  match.stat_player('Adam','hanga','zvezda',33,19,4,3);
exec  match.stat_player('Yago','Mateus','zvezda',33,2,0,1);
exec  match.stat_player('branko','lazic','zvezda',33,0,1,0);

exec  match.stat_player('MOSES','WRight','olympiacos',33,20,4,0);
exec  match.stat_player('moustapha','fall','olympiacos',33,4,5,6);
exec  match.stat_player('shaquielle','mckissic','olympiacos',33,7,0,0);
exec  match.stat_player('kostas','papanikolaou','olympiacos',33,12,4,6);
exec  match.stat_player('nigel','Williams-Goss','olympiacos',33,10,1,6);
exec  match.stat_player('alec','peters','olympiacos',33,9,3,1);
exec  match.stat_player('isaiah','canaan','olympiacos',33,3,1,1);

--alba - partizan
exec  match.result_match(33,'alba','partizan',15,23,19,24,28,25,21,22,null,null,null,null,null,null,null,null,to_date('26-10-23','dd-mm-yy'));
exec  match.stat_player('aleksa','avramovic','partizan',33,11,3,1);
exec  match.stat_player('kevin','punter','partizan',33,15,6,3);
exec  match.stat_player('james','nunnally','partizan',33,19,0,4);
exec  match.stat_player('Frank','kaminsky','partizan',33,6,4,3);
exec  match.stat_player('pj','dozier','partizan',33,15,2,4);
exec  match.stat_player('alen','smailagic','partizan',33,5,1,0);
exec  match.stat_player('Zach','LeDay','partizan',33,14,6,0);
exec  match.stat_player('danilo','andjusic','partizan',33,5,0,1);
exec  match.stat_player('Bruno','Caboclo','partizan',33,4,2,0);

exec  match.stat_player('john','thiemann','alba',33,20,11,2);
exec  match.stat_player('matt','thomas','alba',33,16,2,0);
exec  match.stat_player('sterling','brown','alba',33,14,1,3);
exec  match.stat_player('yanni','wetzell','alba',33,11,3,1);
exec  match.stat_player('martin','hermannsson','alba',33,8,2,8);

--efes - zvezda
exec  match.result_match(34,'efes','zvezda',15,11,30,20,31,13,24,11,null,null,null,null,null,null,null,null,to_date('11/04/24 19:30','dd/mm/yy hh24:mi'));
exec  match.stat_player('nemanja','nedovic','zvezda',34,11,2,1);
exec  match.stat_player('Joel','bolomboy','zvezda',34,6,8,0);
exec  match.stat_player('Yago','Mateus','zvezda',34,3,1,2);
exec  match.stat_player('milos','teodosic','zvezda',34,2,0,4);
exec  match.stat_player('luka','mitrovic','zvezda',34,11,6,2);
exec  match.stat_player('rokas','giedraitis','zvezda',34,11,5,0);
exec  match.stat_player('adam','hanga','zvezda',34,6,1,1);
exec  match.stat_player('branko','lazic','zvezda',34,0,0,0);

exec  match.stat_player('shane','larkin','efes',34,2,0,7);
exec  match.stat_player('darius','thompson','efes',34,4,1,2);
exec  match.stat_player('william','clyburn','efes',34,9,3,2);
exec  match.stat_player('rodrigue','beaubois','efes',34,4,3,1);
exec  match.stat_player('elijah','bryant','efes',34,26,2,2);
exec  match.stat_player('tibor','pleiss','efes',34,5,3,2);


----------------------------------------------------------------------- COACHES ------------------------------------------------------------------------------

insert into coaches values (13,'Ioannis','Sfairopulos',1,to_date('22/10/2023','dd/mm/yyyy'));
insert into coaches values (14,'Sarunas','Jasikevicius',9,to_date('14/12/2023','dd/mm/yyyy'));
insert into coaches values (15,'Erdem','Can',10,to_date('01/07/2023','dd/mm/yyyy'));
insert into coaches values (16,'Tomislav','Mijatovic',10,to_date('01/02/2024','dd/mm/yyyy'));

update teams set coach_id = 13 where team_id = 1;
update teams set coach_id = 14 where team_id = 9;
update teams set coach_id = 15 where team_id = 10;
update teams set coach_id = 16 where team_id = 10;


---------------------------------------------------------------------- ALL CODE ------------------------------------------------------------------------------

--kreiranje tabele countries
create table countries (
country_id INT,
country_name VARCHAR2(30),
CONSTRAINT pk_countries primary key (country_id)
);
--ubacivanje podataka u countries
insert into countries select * from evroliga.countries;

--kreiranje tabele teams
create table teams (
team_id int,
team_name varchar2(35),
country_id int,
constraint pk_teams primary key (team_id),
constraint fk_teams foreign key (country_id) references countries(country_id)
);
--ubacivanje podataka u teams
insert into teams select e.team_id, e.team_name, c.country_id
from evroliga22.teams e join countries c on e.country_id= c.country_id;
alter table teams add coach_id int;
alter table teams add constraint fk_teams_c_id foreign key (coach_id) references coaches (coach_id);
update teams set coach_id = 1 where team_id = 1;
update teams set coach_id = 2 where team_id = 7;

--kreiranje tabele treneri
create table coaches (
coach_id int,
first_name varchar2(20) not null,
last_name varchar2(20),
team_id int,
start_date date,
constraint pk_coaches primary key (coach_id),
constraint fk_team foreign key (team_id) references teams (team_id)
);
insert into coaches select c1.coach_id,c1.first_name,c1.last_name,c1.team_id,c1.start_date
from evroliga22.coaches c1;


create table coaches_history (
coaches_history_id int,
coach_id int,
coach_name varchar2(50),
team_id int,
team_name varchar2(35),
start_date date,
end_date date,
constraint pk_coaches_history primary key (coaches_history_id),
constraint fk_coaches_history_c_id foreign key (coach_id) references coaches (coach_id),
constraint fk_coaches_history_t_id foreign key (team_id) references teams (team_id)
);
CREATE SEQUENCE coaches_history_seq START WITH 1 INCREMENT BY 1;

--kreiranje trigera za unos promenjenih trenera u tabelu istorije
create or replace trigger coaches_update
after update on coaches
for each row
begin
  insert into coaches_history (coaches_history_id,coach_id,coach_name,team_id,team_name,start_date,end_date)
  values (coaches_history_seq.nextval,:old.coach_id,:old.first_name||' '||:old.last_name,:old.team_id,
          (select team_name from teams where team_id = :old.team_id),:old.start_date,:new.start_date);
end;

----kreiranje trigera za unos promenjenih trenera u tabelu istorije2
create or replace trigger coach_team_update
after update on teams
for each row
begin
  insert into coaches_history (coaches_history_id,coach_id,coach_name,team_id,team_name,start_date,end_date)
  values (coaches_history_seq.nextval,:old.coach_id,(select first_name||' '||last_name from coaches where coach_id = :old.coach_id),
          :old.team_id,:old.team_name,(select start_date from coaches where coach_id = :old.coach_id),(select start_date from coaches where coach_id = :new.coach_id));
end;

--kreiranje tabele matches
create table matches (
match_id int,
round int not null,
home_team_id int not null,
away_team_id int not null,
home_team_score int not null,
away_team_score int not null,
match_date timestamp,
constraint pk_matches primary key (match_id),
constraint fk_matches_home foreign key (home_team_id) references teams (team_id),
constraint fk_matches_away foreign key (away_team_id) references teams (team_id),
constraint chk_matches_scores check (home_team_score>=0 and away_team_score >=0)
);
--kreiranje indeksa za match_date
create index indx_match_date on matches (match_date);

--kreiranje sekvence za match_id
create sequence match_id_seq start with 1 increment by 1 nocache nocycle;
--kreiranje trigera za pracenje sekvence
create or replace trigger matches_match_id
before insert on matches
for each row
begin
  :new.match_id := match_id_seq.nextval;
end;

--kreiranje tabele standings
create table standings(
position int,
team_name varchar2(35) not null,
mp int,
won int,
lost int,
"PTS+" int,
"PTS-" int,
"+/-" int,
constraint pk_standings primary key (position)
);

--kreiranje sekvence za tabelu plasmana
create sequence standings_position start with 1 increment by 1 maxvalue 18 cycle cache 2;

--kreiranje trigera za poziciju u tabeli plasmana
create or replace trigger trg_stand_pos_seq
before insert or update on standings
for each row
begin
  if :new.position is null then
    :new.position := standings_position.nextval;
  end if;
end;

--procedura za izracunavanje pobeda, poraza itd...
create or replace procedure calculate_standings is
begin
 --Brisemo prethodne podatke sa delete:
    delete from standings;
    
    INSERT INTO standings (position, team_name, mp, won, lost, "PTS+", "PTS-", "+/-")
    SELECT 
        null, --row_number() OVER (ORDER BY count(*)) AS position,
        t.team_name,
        COUNT(m.match_id) AS mp,
        SUM(CASE WHEN m.home_team_id = t.team_id AND m.home_team_score > m.away_team_score THEN 1
                 WHEN m.away_team_id = t.team_id AND m.away_team_score > m.home_team_score THEN 1 ELSE 0 END) AS won,
        SUM(CASE WHEN m.home_team_id = t.team_id AND m.home_team_score < m.away_team_score THEN 1
                 WHEN m.away_team_id = t.team_id AND m.away_team_score < m.home_team_score THEN 1 ELSE 0 END) AS lost,
        SUM(CASE WHEN m.home_team_id = t.team_id THEN m.home_team_score ELSE m.away_team_score END) AS "PTS+",
        SUM(CASE WHEN m.home_team_id = t.team_id THEN m.away_team_score ELSE m.home_team_score END) AS "PTS-",
        SUM(case when m.home_team_id = t.team_id then m.home_team_score - m.away_team_score 
                 when m.away_team_id = t.team_id then m.away_team_score - m.home_team_score end) AS "+/-"
    FROM teams t 
    LEFT OUTER JOIN 
        matches m 
    ON 
        t.team_id = m.home_team_id OR t.team_id = m.away_team_id
      group by team_name
      order by won desc, lost asc,mp desc,"+/-" desc,"PTS+" desc,"PTS-" asc;

    COMMIT;
END calculate_standings;

begin
  calculate_standings;
end;

--kreiranje trigera za vracanje podataka u standings nakon brisanja utakmice
create or replace TRIGGER standings_after_delete
after delete on MATCHES
for each row
begin
  update standings
  set mp = mp - 1, 
  won = case when :old.home_team_score > :old.away_team_score and team_name = (select team_name from teams where team_id = :old.home_team_id) then won - 1
  when :old.home_team_score < :old.away_team_score and team_name = (select team_name from teams where team_id = :old.away_team_id) then won - 1
  else won
  end,
  lost = case when :old.home_team_score < :old.away_team_score and team_name = (select team_name from teams where team_id = :old.home_team_id) then lost - 1
  when :old.home_team_score > :old.away_team_score and team_name = (select team_name from teams where team_id = :old.away_team_id) then lost - 1
  else lost
  end,
  "PTS+" = case when team_name = (select team_name from teams where team_id = :old.home_team_id) then "PTS+" - :old.home_team_score
  when team_name = (select team_name from teams where team_id = :old.away_team_id) then "PTS+" - :old.away_team_score
  else "PTS+"
  end,
  "PTS-" = case when team_name = (select team_name from teams where team_id = :old.home_team_id) then "PTS-" - :old.away_team_score
  when team_name = (select team_name from teams where team_id = :old.away_team_id) then "PTS-"- :old.home_team_score
  else "PTS-"
  end,
  "+/-" = case when team_name = (select team_name from teams where team_id = :old.home_team_id) then "+/-" - (:old.home_team_score - :old.away_team_score)
  when team_name = (select team_name from teams where team_id = :old.away_team_id) then "+/-" - (:old.away_team_score - :old.home_team_score)
  else "+/-"
  end
  where team_name in (select team_name from teams where team_id = :old.home_team_id or team_id = :old.away_team_id);
end;

--kreiranje tabele players
create table players (
player_id int,
first_name varchar2(20) not null,
last_name varchar2(20),
position varchar2(2),
team_id int,
constraint pk_player_id primary key (player_id),
constraint fk_players foreign key (team_id) references teams (team_id)
);

--kreiranje tabele players_history
create table players_history (
player_history_id int,
player_id int,
player_name varchar2(40),
team_id int,
team_name varchar2(30),
start_date date,
end_date date,
constraint pk_players_history primary key (player_history_id),
constraint fk_players_hist_player_id foreign key (player_id) references players (player_id),
constraint fk_players_hist_team_id foreign key (team_id) references teams(team_id)
);
create sequence players_history_seq start with 1 increment by 1 nocache

--kreiranje trigera za unos promenjenih igraca u tabelu istorije
create or replace trigger players_update
after update of team_id on players
for each row
begin
  insert into players_history (player_history_id,player_id,player_name,team_id,team_name,start_date,end_date)
  values (players_history_seq.nextval,:old.player_id,:old.first_name||' '||:old.last_name,:old.team_id,
          (select team_name from teams where team_id = :old.team_id),:old.start_date,:new.start_date);
end;

--kreiranje tabele players_stat
create table players_stat (
player_stat_id int,
player_id int,
match_id int,
points int,
rebounds int,
assists int,
constraint pk_player_stat primary key (player_stat_id),
constraint fk_player_id foreign key (player_id) references players (player_id) on delete cascade,
constraint fk_match_id foreign key (match_id) references matches (match_id) on delete cascade,
constraint chk_stat_nn check (points >=0 and rebounds >=0 and assists >=0)
);

--kreiranje paketa za unos meceva i igraca
create or replace package match as 
  procedure result_match (p_round int,p_home_team varchar2,p_away_team varchar2,p_h_q1 int,p_a_q1 int,p_h_q2 int, 
  p_a_q2 int,p_h_q3 int,p_a_q3 int,p_h_q4 int,p_a_q4 int,p_h_e1 int default null,p_a_e1 int default null,
  p_h_e2 int default null,p_a_e2 int default null,p_h_e3 int default null,p_a_e3 int default null,p_h_e4 int default null,
  p_a_e4 int default null, p_match_date date);
  procedure stat_player (p_name varchar2,p_last_name varchar2,p_team varchar2,p_round int,p_points int,p_rebounds int,
  p_assists int);
end match;

create or replace package body match as
  --statistika meca
  procedure result_match (p_round int,p_home_team varchar2,p_away_team varchar2,p_h_q1 int,p_a_q1 int,p_h_q2 int, 
  p_a_q2 int,p_h_q3 int,p_a_q3 int,p_h_q4 int,p_a_q4 int,p_h_e1 int default null,p_a_e1 int default null,
  p_h_e2 int default null,p_a_e2 int default null,p_h_e3 int default null,p_a_e3 int default null,p_h_e4 int default null,
  p_a_e4 int default null, p_match_date date) is
  v_home_team_id int;
  v_away_team_id int;
  v_home_team varchar2(30);
  v_away_team varchar2(30);
  v_home_team_score int;
  v_away_team_score int;
begin
  select team_id into v_home_team_id from teams where upper(team_name) like upper('%'||p_home_team||'%');
  select team_id into v_away_team_id from teams where upper(team_name) like upper('%'||p_away_team||'%');

  select team_name into v_home_team from teams where upper(team_name) like upper('%'||p_home_team||'%');
  select team_name into v_away_team from teams where upper(team_name) like upper('%'||p_away_team||'%');

    v_home_team_score := p_h_q1 + p_h_q2 + p_h_q3 + p_h_q4 + coalesce(p_h_e1,0) + coalesce(p_h_e2,0) + coalesce(p_h_e3,0)
    + coalesce(p_h_e4,0);
    v_away_team_score := p_a_q1 + p_a_q2 + p_a_q3 + p_a_q4 + coalesce(p_a_e1,0) + coalesce(p_a_e2,0) + coalesce(p_a_e3,0)
    + coalesce(p_a_e4,0);

  if p_h_q1<0 or p_h_q2<0 or p_h_q3<0 or p_h_q4<0 or p_a_q1<0 or p_a_q2<0 or p_a_q3<0 or p_a_q4<0 or p_h_e1<0 or p_h_e2<0 
    or p_h_e3 <0 or p_h_e4<0 or p_a_e1<0 or p_a_e2<0 or p_a_e3<0 or p_a_e4<0 then
        dbms_output.put_line('Poeni po cetvrtinama ne mogu biti negativni brojevi!');
  end if;

  insert into matches (match_id, round, home_team_id, away_team_id, home_team_score, away_team_score, match_date)
  values (match_id_seq.nextval,p_round,v_home_team_id,v_away_team_id,v_home_team_score,v_away_team_score,p_match_date);
calculate_standings;
  dbms_output.put_line('Uspesno ste uneli podatke o mecu '''||v_home_team||' - '||v_away_team||''', za '''||p_round||'.'' rundu.');
  end result_match;
  
  --statistika igraca
  procedure stat_player (p_name varchar2,p_last_name varchar2,p_team varchar2,p_round int,p_points int,p_rebounds int,
  p_assists int) is
  v_counter int;
  v_pcounter int;
  v_player_id int;
  v_match_id int;
  v_team_name varchar2(30);
  v_team_id int;
  v_home varchar2(30);
  v_away varchar2(30);
  v_count int;
begin
  select team_name into v_team_name from teams where upper(team_name) like upper('%'||p_team||'%');
  select team_id into v_team_id from teams where team_name = v_team_name;  
    begin
      select player_id into v_player_id from players where (first_name = initcap(p_name) and
      last_name = initcap(p_last_name)) and team_id = v_team_id;
    exception
      when no_data_found then
        v_player_id := null;
   end;

  if (v_player_id is not null) then
    select match_id into v_match_id from matches where round = p_round and 
    (home_team_id = v_team_id or away_team_id = v_team_id);
    select team_name into v_home from teams join matches on teams.team_id=matches.home_team_id where match_id = v_match_id;
    select team_name into v_away from teams join matches on teams.team_id=matches.away_team_id where match_id = v_match_id;
    select count(*) into v_count from players_stat where match_id = v_match_id and player_id = v_player_id;
    
    if(v_count = 0) then
      select max(player_stat_id)+1 into v_counter from players_stat;
  
      insert into players_stat (player_stat_id, player_id, match_id, points, rebounds, assists) 
      values (v_counter,v_player_id,v_match_id,p_points,p_rebounds,p_assists);
      dbms_output.put_line('Uspesno ste uneli statistiku za igraca '''||initcap(p_name)||' '||initcap(p_last_name)||
      ''' za mec '''||v_home||' - '||v_away||'''.');
    else
      dbms_output.put_line('Statistika za igraca '''||initcap(p_name)||' '||initcap(p_last_name) ||''' za utakmicu '''||
      v_home||' - '||v_away||''' vec postoji!');
    end if;
    
  else
    select max(player_id)+1 into v_pcounter from players;
    if v_pcounter is null then
        v_pcounter := 1;
    end if;
  
  insert into players (player_id, first_name, last_name, position, team_id,START_DATE,END_DATE) 
  values (v_pcounter,initcap(p_name),initcap(p_last_name),null,v_team_id,TO_DATE('01/07/'||(extract(year from sysdate)-1),'dd/mm/yyyy'),to_date('01/01/99','dd/mm/yy'));
  dbms_output.put_line('Uspesno ste uneli igraca '''||initcap(p_name)||' '||initcap(p_last_name)||''' u tabelu igraca.');
  
  select player_id into v_player_id from players where first_name = initcap(p_name) and last_name = initcap(p_last_name) 
  and team_id = v_team_id;
  select match_id into v_match_id from matches where round = p_round and 
  (home_team_id = v_team_id or away_team_id = v_team_id);
  select team_name into v_home from teams join matches on teams.team_id=matches.home_team_id where match_id = v_match_id;
  select team_name into v_away from teams join matches on teams.team_id=matches.away_team_id where match_id = v_match_id;
  select max(player_stat_id)+1 into v_counter from players_stat;
    if v_counter is null then
        v_counter := 1;
    end if;
  
  insert into players_stat (player_stat_id, player_id, match_id, points, rebounds, assists) 
  values (v_counter,v_player_id,v_match_id,p_points,p_rebounds,p_assists);
  dbms_output.put_line('Uspesno ste uneli statistiku za igraca '''||initcap(p_name)||' '||initcap(p_last_name)||
  ''', za mec '''||v_home||' - '||v_away||'''.');
  end if;

exception
  when others then
    dbms_output.put_line('Doslo je do greske prilikom unosa podataka.');
  end stat_player;
  
end match;

insert into matches select m.match_id,m.round,ht.team_id as home_team_id,at.team_id as away_team_id,
m.home_team_score,m.away_team_score,m.match_date from evroliga.matches m join evroliga.teams ht on
m.home_team = ht.team_name join evroliga.teams at on m.away_team = at.team_name;
truncate table matches;
insert into players select P.PLAYER_ID,P.FIRST_NAME,P.LAST_NAME,P.POSITION,T.TEAM_ID from evroliga.players P
JOIN EVROLIGA.TEAMS T ON P.TEAM_NAME = T.TEAM_NAME;

INSERT INTO PLAYERS_STAT SELECT * FROM EVROLIGA.PLAYERS_STAT where match_id != 4 and match_id != 5;
truncate table PLAYERS_STAT;

--OD UTAKMICA IZ EVROLIGA BAZE UNETI SU PODACI O IGRACIMA SAMO ZA 33. RUNDU, OSTALO SU SAMO CZV I PAR

alter table players add start_date date;
alter table players add end_date date;
update players
set start_date = to_date('01/07/23','dd/mm/yy'), end_date = to_date('01/01/2399','dd/mm/yyyy');

