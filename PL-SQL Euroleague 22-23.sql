--Efes - Zvezda
exec  match.result_match(1,'efes','zvezda',17,14,18,20,21,16,16,9,null,null,null,null,null,null,null,null,to_timestamp('07/10/22 19:30','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',1,13,4,2);
exec  match.stat_player('nikola','ivanovic','zvezda',1,9,3,5);
exec  match.stat_player('luka','mitrovic','zvezda',1,3,4,5);
exec  match.stat_player('hassan','martin','zvezda',1,8,4,0);
exec  match.stat_player('filip','petrusev','zvezda',1,6,6,1);
exec  match.stat_player('branko','lazic','zvezda',1,5,6,0);

exec  match.stat_player('william','clyburn','efes',1,19,3,1);
exec  match.stat_player('vasilije','micic','efes',1,16,0,6);
exec  match.stat_player('rodrigue','beaubois','efes',1,10,4,2);
exec  match.stat_player('elijah','bryant','efes',1,4,4,0);
exec  match.stat_player('tibor','pleiss','efes',1,2,4,0);

--Alba - Partizan
exec  match.result_match(1,'alba','partizan',33,18,28,25,16,18,23,23,null,null,null,null,null,null,null,null,to_date('07-10-22 20:00','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',1,3,6,3);
exec  match.stat_player('james','nunnally','partizan',1,7,2,1);
exec  match.stat_player('dante','exum','partizan',1,22,3,4);
exec  match.stat_player('Zach','LeDay','partizan',1,13,1,1);
exec  match.stat_player('danilo','andjusic','partizan',1,14,1,2);
exec  match.stat_player('mathias','lessort','partizan',1,9,6,0);

exec  match.stat_player('john','thiemann','alba',1,8,5,5);
exec  match.stat_player('tamir','blatt','alba',1,16,0,4);
exec  match.stat_player('luke','sikma','alba',1,15,6,7);
exec  match.stat_player('jaleen','smith','alba',1,9,0,2);
exec  match.stat_player('christ','koumadje','alba',1,8,6,0);

--Zvezda - Panathinaikos
exec  match.result_match(2,'zvezda','panathina',24,18,14,24,18,15,19,20,null,null,null,null,null,null,null,null,to_timestamp('13/10/22 19:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',2,18,6,1);
exec  match.stat_player('nikola','ivanovic','zvezda',2,7,2,3);
exec  match.stat_player('luka','mitrovic','zvezda',2,8,6,2);
exec  match.stat_player('hassan','martin','zvezda',2,12,3,0);
exec  match.stat_player('filip','petrusev','zvezda',2,5,0,1);
exec  match.stat_player('branko','lazic','zvezda',2,6,3,2);
exec  match.stat_player('ognjen','dobric','zvezda',2,7,2,1);

exec  match.stat_player('marius','grigonis','panathinai',2,17,2,3);
exec  match.stat_player('mateusz','ponitka','panathinai',2,10,4,3);
exec  match.stat_player('paris','lee','panathinai',2,6,1,2);
exec  match.stat_player('georgios','papagiannis','panathinai',2,9,7,1);

--Partizan - Virtus
exec  match.result_match(4,'partizan','virtus',27,11,24,21,18,15,21,15,null,null,null,null,null,null,null,null,to_date('20-10-22 20:30','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',4,10,3,3);
exec  match.stat_player('james','nunnally','partizan',4,20,4,4);
exec  match.stat_player('dante','exum','partizan',4,3,2,2);
exec  match.stat_player('Zach','LeDay','partizan',4,4,9,1);
exec  match.stat_player('danilo','andjusic','partizan',4,14,2,1);
exec  match.stat_player('mathias','lessort','partizan',4,14,7,0);
exec  match.stat_player('ioannis','papapetrou','partizan',4,2,2,1);

exec  match.stat_player('daniel','hackett','virtus',4,5,0,1);
exec  match.stat_player('jordan','mickey','virtus',4,5,3,0);
exec  match.stat_player('gabriel','lundberg','virtus',4,4,0,1);
exec  match.stat_player('marco','belinelli','virtus',4,3,3,2);
exec  match.stat_player('milos','teodosic','virtus',4,0,0,4);

--Real - Zvezda
exec  match.result_match(4,'real','zvezda',25,10,14,20,15,14,18,12,null,null,null,null,null,null,null,null,to_timestamp('21/10/22 20:45','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',4,17,5,0);
exec  match.stat_player('nikola','ivanovic','zvezda',4,0,1,2);
exec  match.stat_player('luka','mitrovic','zvezda',4,2,4,0);
exec  match.stat_player('hassan','martin','zvezda',4,8,2,0);
exec  match.stat_player('filip','petrusev','zvezda',4,0,5,0);
exec  match.stat_player('branko','lazic','zvezda',4,0,0,0);
exec  match.stat_player('ognjen','dobric','zvezda',4,8,2,1);
exec  match.stat_player('luca','vildoza','zvezda',4,10,1,4);

exec  match.stat_player('dzanan','musa','real',4,13,4,1);
exec  match.stat_player('mario','hezonja','real',4,0,1,1);
exec  match.stat_player('gabriel','deck','real',4,12,9,5);
exec  match.stat_player('edy','tavares','real',4,10,6,0);
exec  match.stat_player('vincent','poirier','real',4,5,3,1);
exec  match.stat_player('guerschon','yabusele','real',4,11,4,2);

--Panathinaikos - Partizan
exec  match.result_match(6,'panathina','partizan',16,31,25,23,23,14,25,23,null,null,null,null,null,null,null,null,to_date('03-11-22 20:30','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',6,29,1,4);
exec  match.stat_player('dante','exum','partizan',6,12,2,2);
exec  match.stat_player('Zach','LeDay','partizan',6,13,10,2);
exec  match.stat_player('danilo','andjusic','partizan',6,10,1,1);
exec  match.stat_player('mathias','lessort','partizan',6,15,11,2);
exec  match.stat_player('ioannis','papapetrou','partizan',6,2,3,1);

exec  match.stat_player('marius','grigonis','panathinai',6,9,1,2);
exec  match.stat_player('mateusz','ponitka','panathinai',6,12,4,3);
exec  match.stat_player('paris','lee','panathinai',6,4,2,2);
exec  match.stat_player('georgios','papagiannis','panathinai',6,10,5,0);

--Fenerbahce - Zvezda
exec  match.result_match(7,'fenerbahce','zvezda',24,23,18,18,24,16,27,22,null,null,null,null,null,null,null,null,to_timestamp('10/11/22 18:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',7,12,4,0);
exec  match.stat_player('nikola','ivanovic','zvezda',7,6,3,1);
exec  match.stat_player('nemanja','nedovic','zvezda',7,17,2,4);
exec  match.stat_player('hassan','martin','zvezda',7,3,2,0);
exec  match.stat_player('filip','petrusev','zvezda',7,8,2,1);
exec  match.stat_player('branko','lazic','zvezda',7,5,0,1);
exec  match.stat_player('luca','vildoza','zvezda',7,13,3,3);

exec  match.stat_player('dyshawn','pierre','fenerb',7,10,2,5);
exec  match.stat_player('devin','booker','fenerb',7,0,4,2);
exec  match.stat_player('johnathan','motley','fenerb',7,25,10,0);
exec  match.stat_player('marko','guduric','fenerb',7,17,5,3);
exec  match.stat_player('nick','calathes','fenerb',7,8,4,6);
exec  match.stat_player('nigel','hayes-Davis','fenerb',7,10,6,2);
exec  match.stat_player('scott','wilbekin','fenerb',7,1,0,3);

--Olympiacos - Partizan
exec  match.result_match(7,'olympiacos','partizan',22,14,23,24,23,16,19,04,null,null,null,null,null,null,null,null,to_date('10-11-22 20:00','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',7,14,0,2);
exec  match.stat_player('Zach','LeDay','partizan',7,6,5,0);
exec  match.stat_player('mathias','lessort','partizan',7,10,6,1);
exec  match.stat_player('ioannis','papapetrou','partizan',7,12,4,1);
exec  match.stat_player('james','nunnally','partizan',7,14,6,3);

exec  match.stat_player('isaiah','canaan','olympiacos',7,10,1,0);
exec  match.stat_player('kostas','sloukas','olympiacos',7,17,1,8);
exec  match.stat_player('sasha','vezenkov','olympiacos',7,15,7,4);
exec  match.stat_player('joel','bolomboy','olympiacos',7,4,2,0);
exec  match.stat_player('moustapha','fall','olympiacos',7,6,4,3);
exec  match.stat_player('alec','peters','olympiacos',7,10,5,0);
exec  match.stat_player('shaquielle','mcKissic','olympiacos',7,0,0,1);
exec  match.stat_player('kostas','papanikolaou','olympiacos',7,10,1,2);

--Real - Partizan
exec  match.result_match(10,'real','partizan',32,40,22,11,32,23,19,23,null,null,null,null,null,null,null,null,to_date('24-11-22 20:45','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',10,16,5,3);
exec  match.stat_player('dante','exum','partizan',10,17,4,0);
exec  match.stat_player('Zach','LeDay','partizan',10,20,6,6);
exec  match.stat_player('danilo','andjusic','partizan',10,13,0,4);
exec  match.stat_player('mathias','lessort','partizan',10,8,3,0);
exec  match.stat_player('ioannis','papapetrou','partizan',10,0,0,1);
exec  match.stat_player('james','nunnally','partizan',10,15,2,4);

exec  match.stat_player('dzanan','musa','real',10,14,1,4);
exec  match.stat_player('mario','hezonja','real',10,15,4,0);
exec  match.stat_player('gabriel','deck','real',10,15,1,4);
exec  match.stat_player('edy','tavares','real',10,17,8,0);
exec  match.stat_player('vincent','poirier','real',10,4,4,0);
exec  match.stat_player('Nigel','williams-Goss','real',10,8,1,3);

--Zvezda - Virtus
exec  match.result_match(11,'zvezda','virtus',17,23,25,18,25,14,16,19,null,null,null,null,null,null,null,null,to_timestamp('02/12/22 18:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',11,12,4,2);
exec  match.stat_player('nemanja','nedovic','zvezda',11,5,1,1);
exec  match.stat_player('hassan','martin','zvezda',11,4,3,0);
exec  match.stat_player('filip','petrusev','zvezda',11,4,1,0);
exec  match.stat_player('branko','lazic','zvezda',11,3,0,1);
exec  match.stat_player('luca','vildoza','zvezda',11,16,3,5);
exec  match.stat_player('ognjen','dobric','zvezda',11,20,1,3);
exec  match.stat_player('luka','mitrovic','zvezda',11,12,5,3);

exec  match.stat_player('daniel','hackett','virtus',11,6,0,2);
exec  match.stat_player('jordan','mickey','virtus',11,11,4,3);
exec  match.stat_player('gabriel','lundberg','virtus',11,2,2,1);
exec  match.stat_player('marco','belinelli','virtus',11,4,1,2);

--Partizan - Zvezda
exec  match.result_match(12,'partizan','zvezda',20,11,13,29,19,14,21,22,null,null,null,null,null,null,null,null,to_timestamp('08/12/22 20:30','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',12,6,2,0);
exec  match.stat_player('nemanja','nedovic','zvezda',12,20,0,4);
exec  match.stat_player('luca','vildoza','zvezda',12,14,4,6);
exec  match.stat_player('hassan','martin','zvezda',12,8,7,1);
exec  match.stat_player('filip','petrusev','zvezda',12,10,4,0);
exec  match.stat_player('branko','lazic','zvezda',12,3,1,2);
exec  match.stat_player('ognjen','dobric','zvezda',12,9,1,1);
exec  match.stat_player('luka','mitrovic','zvezda',12,4,3,0);

exec  match.stat_player('kevin','punter','partizan',12,15,1,0);
exec  match.stat_player('dante','exum','partizan',12,5,3,0);
exec  match.stat_player('Zach','LeDay','partizan',12,4,4,1);
exec  match.stat_player('danilo','andjusic','partizan',12,5,0,1);
exec  match.stat_player('mathias','lessort','partizan',12,11,10,3);
exec  match.stat_player('ioannis','papapetrou','partizan',12,13,6,2);
exec  match.stat_player('james','nunnally','partizan',12,0,0,0);
exec  match.stat_player('alen','smailagic','partizan',12,2,0,0);

--Zvezda - Real
exec  match.result_match(18,'zvezda','real',16,25,18,13,17,19,08,22,null,null,null,null,null,null,null,null,to_timestamp('10/01/23 19:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('nemanja','nedovic','zvezda',18,18,2,4);
exec  match.stat_player('filip','petrusev','zvezda',18,17,3,0);
exec  match.stat_player('branko','lazic','zvezda',18,0,0,0);
exec  match.stat_player('ognjen','dobric','zvezda',18,11,4,2);
exec  match.stat_player('luka','mitrovic','zvezda',18,0,5,0);

exec  match.stat_player('dzanan','musa','real',18,19,6,0);
exec  match.stat_player('edy','tavares','real',18,17,12,3);
exec  match.stat_player('vincent','poirier','real',18,5,4,0);
exec  match.stat_player('guerschon','yabusele','real',18,8,2,0);
exec  match.stat_player('NIGEL','williams-Goss','real',18,9,4,0);
exec  match.stat_player('adam','hanga','real',18,2,3,1);

--Zvezda - Partizan
exec  match.result_match(21,'zvezda','partizan',18,20,19,25,17,12,24,22,null,null,null,null,null,null,null,null,to_timestamp('27/01/23 19:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',21,2,2,0);
exec  match.stat_player('nemanja','nedovic','zvezda',21,23,0,1);
exec  match.stat_player('luca','vildoza','zvezda',21,26,6,2);
exec  match.stat_player('filip','petrusev','zvezda',21,8,10,1);
exec  match.stat_player('branko','lazic','zvezda',21,2,2,1);
exec  match.stat_player('ognjen','dobric','zvezda',21,13,3,2);
exec  match.stat_player('luka','mitrovic','zvezda',21,2,6,5);
exec  match.stat_player('nikola','ivanovic','zvezda',21,2,2,0);

exec  match.stat_player('kevin','punter','partizan',21,6,1,1);
exec  match.stat_player('dante','exum','partizan',21,20,4,5);
exec  match.stat_player('Zach','LeDay','partizan',21,20,3,0);
exec  match.stat_player('danilo','andjusic','partizan',21,2,0,1);
exec  match.stat_player('mathias','lessort','partizan',21,13,8,0);
exec  match.stat_player('ioannis','papapetrou','partizan',21,0,3,1);
exec  match.stat_player('james','nunnally','partizan',21,3,1,1);
exec  match.stat_player('alen','smailagic','partizan',21,7,4,0);
exec  match.stat_player('aleksa','avramovic','partizan',21,3,1,4);

--Virtus - Zvezda


--Partizan - Efes
exec  match.result_match(14,'partizan','efes',14,10,14,27,25,17,29,25,null,null,null,null,null,null,null,null,to_timestamp('16/12/22 20:30','dd/mm/yy HH24:MI'));
exec  match.stat_player('kevin','punter','partizan',14,18,2,4);
exec  match.stat_player('dante','exum','partizan',14,18,2,4);
exec  match.stat_player('Zach','LeDay','partizan',14,4,3,3);
exec  match.stat_player('mathias','lessort','partizan',14,13,5,0);
exec  match.stat_player('ioannis','papapetrou','partizan',14,2,3,0);
exec  match.stat_player('james','nunnally','partizan',14,18,4,7);
exec  match.stat_player('alen','smailagic','partizan',14,7,3,0);

exec  match.stat_player('william','clyburn','efes',14,7,4,2);
exec  match.stat_player('vasilije','micic','efes',14,14,4,6);
exec  match.stat_player('rodrigue','beaubois','efes',14,30,2,1);
exec  match.stat_player('elijah','bryant','efes',14,0,2,1);
exec  match.stat_player('tibor','pleiss','efes',14,2,3,1);

--Fenerbahce - Partizan
exec  match.result_match(15,'fener','partizan',19,16,18,17,20,18,15,22,null,null,null,null,null,null,null,null,to_timestamp('22/12/22 18:45','dd/mm/yy HH24:MI'));
exec  match.stat_player('kevin','punter','partizan',15,12,5,2);
exec  match.stat_player('dante','exum','partizan',15,10,1,2);
exec  match.stat_player('Zach','LeDay','partizan',15,8,6,2);
exec  match.stat_player('mathias','lessort','partizan',15,12,4,0);
exec  match.stat_player('james','nunnally','partizan',15,5,5,1);
exec  match.stat_player('aleksa','avramovic','partizan',15,6,3,0);
exec  match.stat_player('danilo','andjusic','partizan',15,4,2,2);
exec  match.stat_player('ioannis','papapetrou','partizan',15,5,6,1);
exec  match.stat_player('alen','smailagic','partizan',15,4,1,0);

exec  match.stat_player('dyshawn','pierre','fenerb',15,13,6,1);
exec  match.stat_player('devin','booker','fenerb',15,8,2,1);
exec  match.stat_player('marko','guduric','fenerb',15,4,2,3);
exec  match.stat_player('nick','calathes','fenerb',15,11,7,7);
exec  match.stat_player('nigel','hayes-Davis','fenerb',15,9,7,3);
exec  match.stat_player('scott','wilbekin','fenerb',15,14,2,2);

--Olympiacos - Zvezda
exec  match.result_match(15,'olympiacos','zvezda',22,21,23,20,17,24,24,25,null,null,null,null,null,null,null,null,to_timestamp('22/12/22 20:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',15,3,1,0);
exec  match.stat_player('nemanja','nedovic','zvezda',15,12,2,5);
exec  match.stat_player('luca','vildoza','zvezda',15,22,4,8);
exec  match.stat_player('filip','petrusev','zvezda',15,14,3,1);
exec  match.stat_player('branko','lazic','zvezda',15,6,1,1);
exec  match.stat_player('ognjen','dobric','zvezda',15,12,4,1);
exec  match.stat_player('luka','mitrovic','zvezda',15,13,7,2);

exec  match.stat_player('isaiah','canaan','olympiacos',15,5,0,1);
exec  match.stat_player('kostas','sloukas','olympiacos',15,14,0,9);
exec  match.stat_player('sasha','vezenkov','olympiacos',15,13,6,1);
exec  match.stat_player('joel','bolomboy','olympiacos',15,9,5,0);
exec  match.stat_player('moustapha','fall','olympiacos',15,5,0,1);
exec  match.stat_player('alec','peters','olympiacos',15,2,2,2);
exec  match.stat_player('kostas','papanikolaou','olympiacos',15,9,2,3);
exec  match.stat_player('shaquielle','mcKissic','olympiacos',15,7,0,2);

--Partizan - Fenerbahce
exec  match.result_match(25,'partizan','fener',22,22,24,25,23,21,25,29,null,null,null,null,null,null,null,null,to_timestamp('23/02/23 21:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('kevin','punter','partizan',25,25,1,2);
exec  match.stat_player('dante','exum','partizan',25,17,4,3);
exec  match.stat_player('Zach','LeDay','partizan',25,2,5,0);
exec  match.stat_player('mathias','lessort','partizan',25,15,11,2);
exec  match.stat_player('james','nunnally','partizan',25,2,1,0);
exec  match.stat_player('aleksa','avramovic','partizan',25,2,1,1);
exec  match.stat_player('ioannis','papapetrou','partizan',25,7,1,1);
exec  match.stat_player('alen','smailagic','partizan',25,9,6,0);

exec  match.stat_player('dyshawn','pierre','fenerb',25,21,6,3);
exec  match.stat_player('devin','booker','fenerb',25,5,0,2);
exec  match.stat_player('marko','guduric','fenerb',25,25,2,7);
exec  match.stat_player('nick','calathes','fenerb',25,3,4,5);
exec  match.stat_player('nigel','hayes-Davis','fenerb',25,6,1,1);
exec  match.stat_player('scott','wilbekin','fenerb',25,15,0,2);
exec  match.stat_player('johnathan','motley','fenerb',25,14,4,0);

--Partizan - Alba
exec  match.result_match(26,'partizan','alba',20,19,22,25,35,09,11,21,null,null,null,null,null,null,null,null,to_date('02-03-23 21:00','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',26,16,2,3);
exec  match.stat_player('james','nunnally','partizan',26,0,1,0);
exec  match.stat_player('dante','exum','partizan',26,6,3,4);
exec  match.stat_player('Zach','LeDay','partizan',26,13,3,1);
exec  match.stat_player('danilo','andjusic','partizan',26,6,3,0);
exec  match.stat_player('mathias','lessort','partizan',26,10,6,2);
exec  match.stat_player('aleksa','avramovic','partizan',26,19,0,2);
exec  match.stat_player('ioannis','papapetrou','partizan',26,5,0,0);
exec  match.stat_player('alen','smailagic','partizan',26,6,1,1);

exec  match.stat_player('john','thiemann','alba',26,10,2,1);
exec  match.stat_player('luke','sikma','alba',26,9,4,4);
exec  match.stat_player('jaleen','smith','alba',26,3,3,6);
exec  match.stat_player('christ','koumadje','alba',26,9,10,1);

--Virtus - Partizan
exec  match.result_match(27,'virtus','partizan',26,28,21,17,16,20,16,23,null,null,null,null,null,null,null,null,to_date('07-03-23 20:30','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',27,17,1,1)
exec  match.stat_player('james','nunnally','partizan',27,18,1,2);
exec  match.stat_player('dante','exum','partizan',27,17,7,7);
exec  match.stat_player('Zach','LeDay','partizan',27,8,8,2);
exec  match.stat_player('danilo','andjusic','partizan',27,0,0,1);
exec  match.stat_player('mathias','lessort','partizan',27,5,2,0);
exec  match.stat_player('ioannis','papapetrou','partizan',27,3,0,0);
exec  match.stat_player('aleksa','avramovic','partizan',27,0,0,1);
exec  match.stat_player('alen','smailagic','partizan',27,9,4,2);

exec  match.stat_player('daniel','hackett','virtus',27,5,0,4);
exec  match.stat_player('jordan','mickey','virtus',27,13,9,2);
exec  match.stat_player('marco','belinelli','virtus',27,0,2,0);
exec  match.stat_player('milos','teodosic','virtus',27,11,2,12);

--Zvezda - Efes
exec  match.result_match(27,'zvezda','efes',20,25,29,20,19,22,26,8,null,null,null,null,null,null,null,null,to_timestamp('08/03/23 20:30','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',27,10,2,3);
exec  match.stat_player('facundo','campazzo','zvezda',27,22,3,7);
exec  match.stat_player('luka','mitrovic','zvezda',27,10,4,3);
exec  match.stat_player('hassan','martin','zvezda',27,2,1,1);
exec  match.stat_player('filip','petrusev','zvezda',27,7,2,1);
exec  match.stat_player('luca','vildoza','zvezda',27,6,2,2);
exec  match.stat_player('ognjen','dobric','zvezda',27,15,3,2);
exec  match.stat_player('nemanja','nedovic','zvezda',27,9,0,3);

exec  match.stat_player('william','clyburn','efes',27,12,9,4);
exec  match.stat_player('rodrigue','beaubois','efes',27,15,0,3);
exec  match.stat_player('elijah','bryant','efes',27,10,2,2);

--Panathinaikos - Zvezda
exec  match.result_match(28,'panathina','zvezda',9,17,20,25,23,13,23,11,null,null,null,null,null,null,null,null,to_timestamp('10/03/23 20:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('Benjamin','bentil','zvezda',28,5,4,0);
exec  match.stat_player('nikola','ivanovic','zvezda',28,6,2,0);
exec  match.stat_player('luka','mitrovic','zvezda',28,5,0,0);
exec  match.stat_player('hassan','martin','zvezda',28,0,1,0);
exec  match.stat_player('filip','petrusev','zvezda',28,12,9,0);
exec  match.stat_player('ognjen','dobric','zvezda',28,8,1,0);
exec  match.stat_player('nemanja','nedovic','zvezda',28,12,2,3);
exec  match.stat_player('facundo','campazzo','zvezda',28,0,1,4);
exec  match.stat_player('luca','vildoza','zvezda',28,7,2,4);

exec  match.stat_player('marius','grigonis','panathinai',28,7,4,3);
exec  match.stat_player('mateusz','ponitka','panathinai',28,8,5,3);
exec  match.stat_player('paris','lee','panathinai',28,7,2,5);
exec  match.stat_player('georgios','papagiannis','panathinai',28,17,7,2);

--Efes - Partizan
exec  match.result_match(29,'efes','partizan',23,11,14,28,27,24,20,34,null,null,null,null,null,null,null,null,to_timestamp('16/03/23 18:30','dd/mm/yy HH24:MI'));
exec  match.stat_player('kevin','punter','partizan',29,19,3,1);
exec  match.stat_player('dante','exum','partizan',29,9,2,6);
exec  match.stat_player('Zach','LeDay','partizan',29,16,3,1);
exec  match.stat_player('mathias','lessort','partizan',29,17,7,1);
exec  match.stat_player('ioannis','papapetrou','partizan',29,2,1,0);
exec  match.stat_player('james','nunnally','partizan',29,16,4,1);
exec  match.stat_player('alen','smailagic','partizan',29,0,1,0);
exec  match.stat_player('aleksa','avramovic','partizan',29,14,3,1);

exec  match.stat_player('william','clyburn','efes',29,22,8,2);
exec  match.stat_player('vasilije','micic','efes',29,15,1,5);
exec  match.stat_player('elijah','bryant','efes',29,16,3,2);
exec  match.stat_player('tibor','pleiss','efes',29,7,2,0);
exec  match.stat_player('shane','larkin','efes',29,9,2,6);

--Partizan - Olympiacos
exec  match.result_match(30,'partizan','olympiacos',27,22,21,12,12,18,30,23,null,null,null,null,null,null,null,null,to_date('10-11-22 20:00','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',30,17,1,3);
exec  match.stat_player('dante','exum','partizan',30,15,1,4);
exec  match.stat_player('Zach','LeDay','partizan',30,6,4,0);
exec  match.stat_player('mathias','lessort','partizan',30,12,10,3);
exec  match.stat_player('ioannis','papapetrou','partizan',30,10,3,2);
exec  match.stat_player('james','nunnally','partizan',30,19,4,5);
exec  match.stat_player('alen','smailagic','partizan',30,5,1,0);
exec  match.stat_player('aleksa','avramovic','partizan',30,2,3,1);

exec  match.stat_player('isaiah','canaan','olympiacos',30,4,1,0);
exec  match.stat_player('kostas','sloukas','olympiacos',30,8,1,3);
exec  match.stat_player('sasha','vezenkov','olympiacos',30,6,5,3);
exec  match.stat_player('joel','bolomboy','olympiacos',30,0,2,1);
exec  match.stat_player('moustapha','fall','olympiacos',30,13,6,1);
exec  match.stat_player('alec','peters','olympiacos',30,2,3,0);
exec  match.stat_player('shaquielle','mcKissic','olympiacos',30,21,2,1);
exec  match.stat_player('kostas','papanikolaou','olympiacos',30,9,5,3);

--Partizan - Real
exec  match.result_match(32,'partizan','real',21,23,28,15,29,34,26,18,null,null,null,null,null,null,null,null,to_date('24-11-22 20:45','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',32,16,2,6);
exec  match.stat_player('dante','exum','partizan',32,15,4,3);
exec  match.stat_player('Zach','LeDay','partizan',32,6,2,0);
exec  match.stat_player('danilo','andjusic','partizan',32,5,3,2);
exec  match.stat_player('mathias','lessort','partizan',32,16,8,3);
exec  match.stat_player('ioannis','papapetrou','partizan',32,10,5,0);
exec  match.stat_player('james','nunnally','partizan',32,14,2,2);
exec  match.stat_player('alen','smailagic','partizan',32,11,0,1);
exec  match.stat_player('aleksa','avramovic','partizan',32,5,2,1);

exec  match.stat_player('dzanan','musa','real',32,22,2,3);
exec  match.stat_player('mario','hezonja','real',32,17,3,3);
exec  match.stat_player('gabriel','deck','real',32,17,7,3);
exec  match.stat_player('edy','tavares','real',32,7,4,3);
exec  match.stat_player('vincent','poirier','real',32,9,1,0);
exec  match.stat_player('adam','hanga','real',32,10,1,1);

--Zvezda - Olympiacos
exec  match.result_match(33,'olympiacos','zvezda',26,30,19,17,20,12,22,20,null,null,null,null,null,null,null,null,to_timestamp('06/04/23 19:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('facundo','campazzo','zvezda',33,20,3,8);
exec  match.stat_player('nemanja','nedovic','zvezda',33,0,0,0);
exec  match.stat_player('luca','vildoza','zvezda',33,12,4,5);
exec  match.stat_player('filip','petrusev','zvezda',33,12,5,0);
exec  match.stat_player('ognjen','dobric','zvezda',33,7,4,2);
exec  match.stat_player('luka','mitrovic','zvezda',33,10,3,2);
exec  match.stat_player('hassan','martin','zvezda',33,4,5,1);

exec  match.stat_player('isaiah','canaan','olympiacos',33,6,0,0);
exec  match.stat_player('kostas','sloukas','olympiacos',33,13,3,3);
exec  match.stat_player('sasha','vezenkov','olympiacos',33,16,8,3);
exec  match.stat_player('joel','bolomboy','olympiacos',33,1,1,0);
exec  match.stat_player('moustapha','fall','olympiacos',33,6,7,1);
exec  match.stat_player('alec','peters','olympiacos',33,0,0,0);
exec  match.stat_player('kostas','papanikolaou','olympiacos',33,10,4,1);
exec  match.stat_player('shaquielle','mcKissic','olympiacos',33,10,1,4);

--Zvezda - Fenerbahce
exec  match.result_match(34,'zvezda','fenerbahce',15,21,26,18,16,18,22,22,12,10,null,null,null,null,null,null,to_timestamp('13/04/23 19:00','dd/mm/yy HH24:MI'));
exec  match.stat_player('nemanja','nedovic','zvezda',34,0,0,0);
exec  match.stat_player('hassan','martin','zvezda',34,6,3,0);
exec  match.stat_player('filip','petrusev','zvezda',34,5,6,2);
exec  match.stat_player('ognjen','dobric','zvezda',34,22,3,1);
exec  match.stat_player('luca','vildoza','zvezda',34,17,5,3);
exec  match.stat_player('facundo','campazzo','zvezda',33,24,3,3);
exec  match.stat_player('luka','mitrovic','zvezda',33,12,2,4);

exec  match.stat_player('dyshawn','pierre','fenerb',34,7,5,2);
exec  match.stat_player('johnathan','motley','fenerb',34,27,8,2);
exec  match.stat_player('marko','guduric','fenerb',34,11,5,5);
exec  match.stat_player('nick','calathes','fenerb',34,11,3,12);
exec  match.stat_player('nigel','hayes-Davis','fenerb',34,19,8,2);
exec  match.stat_player('tyler','dorsey','fenerb',34,12,2,2);

--Partizan - Panathinaikos
exec  match.result_match(34,'panathina','partizan',18,26,21,19,19,21,25,15,null,null,null,null,null,null,null,null,to_date('14-04-23 20:30','dd-mm-yy HH24-MI'));
exec  match.stat_player('kevin','punter','partizan',34,17,1,2);
exec  match.stat_player('dante','exum','partizan',34,18,1,4);
exec  match.stat_player('Zach','LeDay','partizan',34,9,4,1);
exec  match.stat_player('danilo','andjusic','partizan',34,2,1,1);
exec  match.stat_player('mathias','lessort','partizan',34,9,9,2);
exec  match.stat_player('ioannis','papapetrou','partizan',34,3,0,2);
exec  match.stat_player('aleksa','avramovic','partizan',34,14,3,3);
exec  match.stat_player('james','nunnally','partizan',34,5,2,1);
exec  match.stat_player('alen','smailagic','partizan',34,4,2,1);

exec  match.stat_player('marius','grigonis','panathinai',34,10,3,0);
exec  match.stat_player('mateusz','ponitka','panathinai',34,12,1,2);
exec  match.stat_player('georgios','papagiannis','panathinai',34,4,5,0);

----------------------------------------------------------------------- COACHES ------------------------------------------------------------------------------

insert into coaches values (1,'Vladimir','Jovanovic',1);
insert into coaches values (2,'Zeljko','Obradovic',2);
insert into coaches values (3,'Chus','Mateo',3);
insert into coaches values (4,'Joan','Penarroya',5);
insert into coaches values (5,'Dejan','Radonjic',8);
insert into coaches values (6,'Dimitris','Itoudis',9);
insert into coaches values (7,'Ergin','Ataman',10);
insert into coaches values (8,'Jorgos','Barcokas',7);

update teams set coach_id = 1 where team_id = 1;
update teams set coach_id = 2 where team_id = 2;
update teams set coach_id = 3 where team_id = 3;
update teams set coach_id = 4 where team_id = 5;
update teams set coach_id = 5 where team_id = 8;
update teams set coach_id = 6 where team_id = 9;
update teams set coach_id = 7 where team_id = 10;

insert into coaches values (9,'Dusko','Ivanovic',1);

update teams set coach_id = 9 where team_id = 1;

---------------------------------------------------------------------- ALL CODE ------------------------------------------------------------------------------

--kreiranje tabele countries
create table countries (
country_id INT,
country_name VARCHAR2(30),
CONSTRAINT pk_countries primary key (country_id)
);
--ubacivanje podataka u countries
insert into countries select * from evroliga.countries;

--kreiranje tabele teams
create table teams (
team_id int,
team_name varchar2(35),
country_id int,
constraint pk_teams primary key (team_id),
constraint fk_teams foreign key (country_id) references countries(country_id)
);
alter table teams add coach_id int;
alter table teams add constraint fk_teams_c_id foreign key (coach_id) references coaches (coach_id);
update teams set coach_id = 1 where team_id = 1;
update teams set coach_id = 2 where team_id = 7;
--ubacivanje podataka u teams
insert into teams select e.team_id, e.team_name, c.country_id 
from evroliga.teams e join countries c on e.country_name = c.country_name;
update teams set team_name = 'CSKA', country_id = 10 where team_id = 2;
update teams set team_name = 'Zenit', country_id = 10 where team_id = 6;
update teams set team_name = 'Unics', country_id = 10 where team_id = 12;

--kreiranje tabele treneri
create table coaches (
coach_id int,
first_name varchar2(20) not null,
last_name varchar2(20),
team_id int,
constraint pk_coaches primary key (coach_id),
constraint fk_team foreign key (team_id) references teams (team_id)
);
insert into coaches values (1,'Dejan','Radonjic');
insert into coaches values (2,'Jorgos','Barcokas');


create table coaches_history (
coaches_history_id int,
coach_id int,
coach_name varchar2(50),
team_id int,
team_name varchar2(35),
end_date date default sysdate,
constraint pk_coaches_history primary key (coaches_history_id),
constraint fk_coaches_history_c_id foreign key (coach_id) references coaches (coach_id),
constraint fk_coaches_history_t_id foreign key (team_id) references teams (team_id)
);
CREATE SEQUENCE coaches_history_seq START WITH 1 INCREMENT BY 1;


create or replace trigger coaches_update
after update on coaches
for each row
begin
  insert into coaches_history (coaches_history_id,coach_id,coach_name,team_id,team_name,end_date)
  values (coaches_history_seq.nextval,:old.coach_id,:old.first_name||' '||:old.last_name,:old.team_id,
          (select team_name from teams where team_id = :old.team_id),sysdate);
end;

--kreiranje tabele matches
create table matches (
match_id int,
round int not null,
home_team_id int not null,
away_team_id int not null,
home_team_score int not null,
away_team_score int not null,
match_date timestamp,
constraint pk_matches primary key (match_id),
constraint fk_matches_home foreign key (home_team_id) references teams (team_id),
constraint fk_matches_away foreign key (away_team_id) references teams (team_id),
constraint chk_matches_scores check (home_team_score>=0 and away_team_score >=0)
);
--kreiranje indeksa za match_date
create index indx_match_date on matches (match_date);

--kreiranje sekvence za match_id
create sequence match_id_seq start with 1 increment by 1 nocache nocycle;
--kreiranje trigera za pracenje sekvence
create or replace trigger matches_match_id
before insert on matches
for each row
begin
  :new.match_id := match_id_seq.nextval;
end;

--kreiranje tabele standings
create table standings(
position int,
team_name varchar2(35) not null,
mp int,
won int,
lost int,
"PTS+" int,
"PTS-" int,
"+/-" int,
constraint pk_standings primary key (position)
);

--kreiranje sekvence za tabelu plasmana
create sequence standings_position start with 1 increment by 1 maxvalue 18 cycle cache 2;

--kreiranje trigera za poziciju u tabeli plasmana
create or replace trigger trg_stand_pos_seq
before insert or update on standings
for each row
begin
  if :new.position is null then
    :new.position := standings_position.nextval;
  end if;
end;

--procedura za izracunavanje pobeda, poraza itd...
create or replace procedure calculate_standings is
begin
 --Brisemo prethodne podatke sa delete:
    delete from standings;
    
    INSERT INTO standings (position, team_name, mp, won, lost, "PTS+", "PTS-", "+/-")
    SELECT 
        null, --row_number() OVER (ORDER BY count(*)) AS position,
        t.team_name,
        COUNT(m.match_id) AS mp,
        SUM(CASE WHEN m.home_team_id = t.team_id AND m.home_team_score > m.away_team_score THEN 1
                 WHEN m.away_team_id = t.team_id AND m.away_team_score > m.home_team_score THEN 1 ELSE 0 END) AS won,
        SUM(CASE WHEN m.home_team_id = t.team_id AND m.home_team_score < m.away_team_score THEN 1
                 WHEN m.away_team_id = t.team_id AND m.away_team_score < m.home_team_score THEN 1 ELSE 0 END) AS lost,
        SUM(CASE WHEN m.home_team_id = t.team_id THEN m.home_team_score ELSE m.away_team_score END) AS "PTS+",
        SUM(CASE WHEN m.home_team_id = t.team_id THEN m.away_team_score ELSE m.home_team_score END) AS "PTS-",
        SUM(case when m.home_team_id = t.team_id then m.home_team_score - m.away_team_score 
                 when m.away_team_id = t.team_id then m.away_team_score - m.home_team_score end) AS "+/-"
    FROM teams t 
    LEFT OUTER JOIN 
        matches m 
    ON 
        t.team_id = m.home_team_id OR t.team_id = m.away_team_id
      group by team_name
      order by won desc, lost asc,mp desc,"+/-" desc,"PTS+" desc,"PTS-" asc;

    COMMIT;
END calculate_standings;

begin
  calculate_standings;
end;

--kreiranje trigera za vracanje podataka u standings nakon brisanja utakmice
create or replace TRIGGER standings_after_delete
after delete on MATCHES
for each row
begin
  update standings
  set mp = mp - 1, 
  won = case when :old.home_team_score > :old.away_team_score and team_name = (select team_name from teams where team_id = :old.home_team_id) then won - 1
  when :old.home_team_score < :old.away_team_score and team_name = (select team_name from teams where team_id = :old.away_team_id) then won - 1
  else won
  end,
  lost = case when :old.home_team_score < :old.away_team_score and team_name = (select team_name from teams where team_id = :old.home_team_id) then lost - 1
  when :old.home_team_score > :old.away_team_score and team_name = (select team_name from teams where team_id = :old.away_team_id) then lost - 1
  else lost
  end,
  "PTS+" = case when team_name = (select team_name from teams where team_id = :old.home_team_id) then "PTS+" - :old.home_team_score
  when team_name = (select team_name from teams where team_id = :old.away_team_id) then "PTS+" - :old.away_team_score
  else "PTS+"
  end,
  "PTS-" = case when team_name = (select team_name from teams where team_id = :old.home_team_id) then "PTS-" - :old.away_team_score
  when team_name = (select team_name from teams where team_id = :old.away_team_id) then "PTS-"- :old.home_team_score
  else "PTS-"
  end,
  "+/-" = case when team_name = (select team_name from teams where team_id = :old.home_team_id) then "+/-" - (:old.home_team_score - :old.away_team_score)
  when team_name = (select team_name from teams where team_id = :old.away_team_id) then "+/-" - (:old.away_team_score - :old.home_team_score)
  else "+/-"
  end
  where team_name in (select team_name from teams where team_id = :old.home_team_id or team_id = :old.away_team_id);
end;

--kreiranje tabele players
create table players (
player_id int,
first_name varchar2(20) not null,
last_name varchar2(20),
position varchar2(2),
team_id int,
constraint pk_player_id primary key (player_id),
constraint fk_players foreign key (team_id) references teams (team_id)
);

--kreiranje tabele players_stat
create table players_stat (
player_stat_id int,
player_id int,
match_id int,
points int,
rebounds int,
assists int,
constraint pk_player_stat primary key (player_stat_id),
constraint fk_player_id foreign key (player_id) references players (player_id) on delete cascade,
constraint fk_match_id foreign key (match_id) references matches (match_id) on delete cascade,
constraint chk_stat_nn check (points >=0 and rebounds >=0 and assists >=0)
);

--kreiranje paketa za unos meceva i igraca
create or replace package match as 
  procedure result_match (p_round int,p_home_team varchar2,p_away_team varchar2,p_h_q1 int,p_a_q1 int,p_h_q2 int, 
  p_a_q2 int,p_h_q3 int,p_a_q3 int,p_h_q4 int,p_a_q4 int,p_h_e1 int default null,p_a_e1 int default null,
  p_h_e2 int default null,p_a_e2 int default null,p_h_e3 int default null,p_a_e3 int default null,p_h_e4 int default null,
  p_a_e4 int default null, p_match_date date);
  procedure stat_player (p_name varchar2,p_last_name varchar2,p_team varchar2,p_round int,p_points int,p_rebounds int,
  p_assists int);
end match;

create or replace package body match as
  --statistika meca
  procedure result_match (p_round int,p_home_team varchar2,p_away_team varchar2,p_h_q1 int,p_a_q1 int,p_h_q2 int, 
  p_a_q2 int,p_h_q3 int,p_a_q3 int,p_h_q4 int,p_a_q4 int,p_h_e1 int default null,p_a_e1 int default null,
  p_h_e2 int default null,p_a_e2 int default null,p_h_e3 int default null,p_a_e3 int default null,p_h_e4 int default null,
  p_a_e4 int default null, p_match_date date) is
  v_home_team_id int;
  v_away_team_id int;
  v_home_team varchar2(30);
  v_away_team varchar2(30);
  v_home_team_score int;
  v_away_team_score int;
begin
  select team_id into v_home_team_id from teams where upper(team_name) like upper('%'||p_home_team||'%');
  select team_id into v_away_team_id from teams where upper(team_name) like upper('%'||p_away_team||'%');

  select team_name into v_home_team from teams where upper(team_name) like upper('%'||p_home_team||'%');
  select team_name into v_away_team from teams where upper(team_name) like upper('%'||p_away_team||'%');

    v_home_team_score := p_h_q1 + p_h_q2 + p_h_q3 + p_h_q4 + coalesce(p_h_e1,0) + coalesce(p_h_e2,0) + coalesce(p_h_e3,0)
    + coalesce(p_h_e4,0);
    v_away_team_score := p_a_q1 + p_a_q2 + p_a_q3 + p_a_q4 + coalesce(p_a_e1,0) + coalesce(p_a_e2,0) + coalesce(p_a_e3,0)
    + coalesce(p_a_e4,0);

  if p_h_q1<0 or p_h_q2<0 or p_h_q3<0 or p_h_q4<0 or p_a_q1<0 or p_a_q2<0 or p_a_q3<0 or p_a_q4<0 or p_h_e1<0 or p_h_e2<0 
    or p_h_e3 <0 or p_h_e4<0 or p_a_e1<0 or p_a_e2<0 or p_a_e3<0 or p_a_e4<0 then
        dbms_output.put_line('Poeni po cetvrtinama ne mogu biti negativni brojevi!');
  end if;

  insert into matches (match_id, round, home_team_id, away_team_id, home_team_score, away_team_score, match_date)
  values (match_id_seq.nextval,p_round,v_home_team_id,v_away_team_id,v_home_team_score,v_away_team_score,p_match_date);
calculate_standings;
  dbms_output.put_line('Uspesno ste uneli podatke o mecu '''||v_home_team||' - '||v_away_team||''', za '''||p_round||'.'' rundu.');
  end result_match;
  
  --statistika igraca
  procedure stat_player (p_name varchar2,p_last_name varchar2,p_team varchar2,p_round int,p_points int,p_rebounds int,
  p_assists int) is
  v_counter int;
  v_pcounter int;
  v_player_id int;
  v_match_id int;
  v_team_name varchar2(30);
  v_team_id int;
  v_home varchar2(30);
  v_away varchar2(30);
  v_count int;
begin
  select team_name into v_team_name from teams where upper(team_name) like upper('%'||p_team||'%');
  select team_id into v_team_id from teams where team_name = v_team_name;  
    begin
      select player_id into v_player_id from players where (first_name = initcap(p_name) and
      last_name = initcap(p_last_name)) and team_id = v_team_id;
    exception
      when no_data_found then
        v_player_id := null;
   end;

  if (v_player_id is not null) then
    select match_id into v_match_id from matches where round = p_round and 
    (home_team_id = v_team_id or away_team_id = v_team_id);
    select team_name into v_home from teams join matches on teams.team_id=matches.home_team_id where match_id = v_match_id;
    select team_name into v_away from teams join matches on teams.team_id=matches.away_team_id where match_id = v_match_id;
    select count(*) into v_count from players_stat where match_id = v_match_id and player_id = v_player_id;
    
    if(v_count = 0) then
      select max(player_stat_id)+1 into v_counter from players_stat;
  
      insert into players_stat (player_stat_id, player_id, match_id, points, rebounds, assists) 
      values (v_counter,v_player_id,v_match_id,p_points,p_rebounds,p_assists);
      dbms_output.put_line('Uspesno ste uneli statistiku za igraca '''||initcap(p_name)||' '||initcap(p_last_name)||
      ''' za mec '''||v_home||' - '||v_away||'''.');
    else
      dbms_output.put_line('Statistika za igraca '''||initcap(p_name)||' '||initcap(p_last_name) ||''' za utakmicu '''||
      v_home||' - '||v_away||''' vec postoji!');
    end if;
    
  else
    select max(player_id)+1 into v_pcounter from players;
    if v_pcounter is null then
        v_pcounter := 1;
    end if;
  
  insert into players (player_id, first_name, last_name, position, team_id) 
  values (v_pcounter,initcap(p_name),initcap(p_last_name),null,v_team_id);
  dbms_output.put_line('Uspesno ste uneli igraca '''||initcap(p_name)||' '||initcap(p_last_name)||''' u tabelu igraca.');
  
  select player_id into v_player_id from players where first_name = initcap(p_name) and last_name = initcap(p_last_name) 
  and team_id = v_team_id;
  select match_id into v_match_id from matches where round = p_round and 
  (home_team_id = v_team_id or away_team_id = v_team_id);
  select team_name into v_home from teams join matches on teams.team_id=matches.home_team_id where match_id = v_match_id;
  select team_name into v_away from teams join matches on teams.team_id=matches.away_team_id where match_id = v_match_id;
  select max(player_stat_id)+1 into v_counter from players_stat;
    if v_counter is null then
        v_counter := 1;
    end if;
  
  insert into players_stat (player_stat_id, player_id, match_id, points, rebounds, assists) 
  values (v_counter,v_player_id,v_match_id,p_points,p_rebounds,p_assists);
  dbms_output.put_line('Uspesno ste uneli statistiku za igraca '''||initcap(p_name)||' '||initcap(p_last_name)||
  ''', za mec '''||v_home||' - '||v_away||'''.');
  end if;

exception
  when others then
    dbms_output.put_line('Doslo je do greske prilikom unosa podataka.');
  end stat_player;
  
end match;

